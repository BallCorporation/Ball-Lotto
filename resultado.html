<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Resultado do Sorteio</title>

<style>
:root {
  --blue1: #0038a8;
  --blue2: #0f4fdc;
  --blue3: #4f8dff;
  --silver1: #e5e7eb;
  --silver2: #9ca3af;
  --white: #ffffff;
}

/* FULL SCREEN */
body {
  margin: 0;
  padding: 0;
  background: #000814;
  color: white;
  height: 100vh;
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
}

#arena {
  width: 100%;
  max-width: 900px;
  height: 300px;
  background: #001226;
  border-radius: 16px;
  border: 1px solid #2a3b5f;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  overflow: hidden;
}

/* FORMATO DA LATA FINAL */
.final-can {
  position: relative;
  width: 90px;
  height: 150px;
  border-radius: 30px;
  margin: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 2rem;
  font-weight: bold;
  color: var(--white);
  animation: pop 0.4s ease-out forwards;
  background-image: linear-gradient(90deg,
    var(--blue1) 0%, var(--blue2) 35%, var(--blue3) 60%, var(--blue2) 85%, var(--blue1) 100%);
}

/* SOMENTE TAMPA SUPERIOR DA LATA FINAL */
.final-can::before {
  content: "";
  position: absolute;
  left: 10px;
  right: 10px;
  height: 14px;
  border-radius: 999px;
  background: radial-gradient(circle at 50% 0,
    var(--white), var(--silver1) 40%, var(--silver2) 70%, #4b5563 100%);
  top: -8px;
}

/* LATA DA ANIMAÇÃO (SPIN) */
.spin-can {
  position: absolute;
  width: 65px;
  height: 120px;
  border-radius: 26px;
  opacity: 0;
  font-size: 1.2rem;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;

  animation: spin 0.3s linear forwards;

  background-image: linear-gradient(90deg,
    var(--blue1) 0%, var(--blue2) 35%, var(--blue3) 60%, var(--blue2) 85%, var(--blue1) 100%);
}

/* TAMPA SUPERIOR NA ANIMAÇÃO */
.spin-can::before {
  content: "";
  position: absolute;
  left: 8px;
  right: 8px;
  height: 12px;
  border-radius: 999px;
  background: radial-gradient(circle at 50% 0,
    var(--white), var(--silver1) 40%, var(--silver2) 70%, #4b5563 100%);
  top: -6px;
}

/* ANIMAÇÕES */
@keyframes spin {
  0% { opacity: 0; transform: scale(0.3) rotate(0deg); }
  50% { opacity: 1; transform: scale(1.1) rotate(180deg); }
  100% { opacity: 0; transform: scale(0.3) rotate(360deg); }
}

@keyframes pop {
  from { transform: scale(0.3); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
</style>
</head>

<body>

<div id="arena"></div>

<script>
function getParam(nome) {
  const url = new URLSearchParams(window.location.search);
  return parseInt(url.get(nome));
}

function random(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

/* SOM DE TAMBOR */
let audioCtx = null;
function tambor() {
  try {
    if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.frequency.value = 120;
    gain.gain.setValueAtTime(0.7, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.20);
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.20);
  } catch(e){}
}

/* ANIMAÇÃO DAS LATAS */
async function animacao(tempo) {
  const arena = document.getElementById("arena");

  const intervalo = setInterval(() => {
    const lata = document.createElement("div");
    lata.className = "spin-can";
    lata.style.left = random(10, arena.clientWidth - 70) + "px";
    lata.style.top = random(10, arena.clientHeight - 130) + "px";
    lata.textContent = random(1, 99);

    arena.appendChild(lata);
    tambor();

    setTimeout(() => lata.remove(), 260);
  }, 80);

  return new Promise(res => {
    setTimeout(() => {
      clearInterval(intervalo);
      arena.innerHTML = "";
      res();
    }, tempo * 1000);
  });
}

/* SORTEIO FINAL */
async function iniciar() {
  const min = getParam("min");
  const max = getParam("max");
  const qtd = getParam("qtd");
  const tempo = getParam("tempo");

  await animacao(tempo);

  const arena = document.getElementById("arena");
  const usados = new Set();
  const nums = [];

  while (nums.length < qtd) {
    const n = random(min, max);
    if (!usados.has(n)) {
      usados.add(n);
      nums.push(n);
    }
  }

  nums.sort((a,b)=>a-b);

  nums.forEach(n => {
    const lata = document.createElement("div");
    lata.className = "final-can";
    lata.textContent = n;
    arena.appendChild(lata);
  });
}

iniciar();
</script>

</body>
</html>
